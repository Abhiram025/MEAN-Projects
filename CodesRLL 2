carModel.js
const mongoose = require('mongoose');

const carSchema = new mongoose.Schema({
  make: { type: String, required: true },
  model: { type: String, required: true },
  cartype: { 
    type: String, 
    required: true,
    enum: ['hyundai', 'sedan', 'suv', 'force', 'honda'] 
  },
  carCategory: { 
    type: String, 
    required: true,
    enum: ['economy', 'premier', 'luxury'] 
  },
  year: { type: Number, required: true },
  pricePerKm: { 
    type: Number,
    required: true,
    min: [0.01, 'Price per km must be positive'], // Minimum 0.01
    validate: {
      validator: Number.isFinite,
      message: 'Price per km must be a valid number'
    }
   },
  pricePerDay: { 
    type: Number,
    required: true,
    min: [0.01, 'Price per day must be positive'], // Minimum 0.01
    validate: {
      validator: Number.isFinite,
      message: 'Price per day must be a valid number'
    }
  },
  availabilityStatus: { 
    type: String, 
    enum: ['available', 'rented', 'maintenance'], 
    default: 'available' 
  },
  currentOdometer: { type: Number, required: true },
  imageUrl: [String],
  features: [String]
}, { timestamps: true });


module.exports = mongoose.model('Car', carSchema);

carRouter.js
const express = require('express');
const router = express.Router();
const carController = require('../controllers/carController');
const { authenticate } = require('../middleware/auth');

// Public routes
router.get('/', carController.getAvailableCars);
router.get('/:id', carController.getCarById);
router.get('/type/:cartype', carController.getCarsByType);

// Admin-only routes
router.use(authenticate);
router.post('/', carController.createCar);
router.put('/:id', carController.updateCar);
router.delete('/:id', carController.deleteCar);

module.exports = router;

carController.js
const CarService = require('../services/carService');

class CarController {
  async createCar(req, res) {
    try {
      if (req.user.role !== 'admin') {
        return res.status(403).json({ message: 'Forbidden' });
      }
      const car = await CarService.createCar(req.body);
      res.status(201).json(car);
    } catch (error) {
      console.log("you are not admin")
      res.status(400).json({ message: error.message });
    }
  }

  async updateCar(req, res) {
    try {
      if (req.user.role !== 'admin') {
        return res.status(403).json({ message: 'Forbidden' });
      }
      const car = await CarService.updateCar(req.params.id, req.body);
      res.json(car);
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  }

  async deleteCar(req, res) {
    try {
      if (req.user.role !== 'admin') {
        return res.status(403).json({ message: 'Forbidden' });
      }
      await CarService.deleteCar(req.params.id);
      res.json({ message: 'Car deleted successfully' });
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  }

  async getAvailableCars(req, res) {
    try {
      const cars = await CarService.getAvailableCars();
      res.json(cars);
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  }

  async getCarsByType(req, res) {
    try {
      const cars = await CarService.getCarsByType(req.params.cartype);
      res.json(cars);
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  }

  async getCarById(req, res) {
    try {
      const car = await CarService.getCarById(req.params.id);
      res.json(car);
    } catch (error) {
      res.status(404).json({ message: error.message });
    }
  }
}

module.exports = new CarController();

carService.js
const CarDAL = require('../dal/carDal');

class CarService {
  async createCar(carData) {
    return await CarDAL.create(carData);
  }

  async updateCar(carId, carData) {
    return await CarDAL.updateById(carId, carData);
  }

  async deleteCar(carId) {
    return await CarDAL.deleteById(carId);
  }

  async getAvailableCars() {
    return await CarDAL.findAvailableCars();
  }

  async getCarsByType(carType) {
    return await CarDAL.findByType(carType);
  }

  async getCarById(carId) {
    return await CarDAL.findById(carId);
  }
}

module.exports = new CarService();

carDal.js
const BaseDAL = require('./baseDal');
const Car = require('../models/carModel');

class CarDAL extends BaseDAL {
  constructor() {
    super(Car);
  }

  async findAvailableCars() {
    return await this.find({ availabilityStatus: 'available' });
  }

  async findByType(carType) {
    return await this.find({ cartype: { $regex: new RegExp(`^${carType}$`, 'i') }, availabilityStatus: 'available' });
  }
}

module.exports = new CarDAL();

auth.js
const jwt = require('jsonwebtoken');
const config = require('../config');

module.exports = {
  authenticate: (req, res, next) => {
    const authHeader = req.headers['authorization'] || req.headers['Authorization'];
    if (!authHeader) {
      return res.status(401).json({ message: 'No token, authorization denied' });
    }

    const token=authHeader.replace(/^Bearer\s+/i, '')
    console.log("Extracted token: ", token)//debug

    if(!token) {
      return res.status(401).json({message: 'No token, authorization denied'})
    }
    try {
      const decoded = jwt.verify(token, config.JWT_SECRET);
      console.log('Decoded Token Payload: ', decoded)//debug
      req.user = decoded;
      next();
    } catch (error) {
      console.error('JWT Verification Error: ', error)//debug
      res.status(401).json({ message: 'Token is not valid' });
    }
  },

  authorizeAdmin: (req, res, next) => {
    if (req.user.role !== 'admin') {
      return res.status(403).json({ message: 'Forbidden' });
    }
    next();
  }
};

these are the codes used to mess with cars database like fetching creating and deleting i just want to store images in imageUrl how to do it from backend like postman 


{
    "imageUrl":[
        "assets/honda[0].jfif",
        "assets/honda[1].jfif",
        "assets/honda[2].jfif"
    ]
}

{
    "message": "Cast to ObjectId failed for value \"{ imageUrl: [] }\" (type Object) at path \"_id\" for model \"Car\""
}
